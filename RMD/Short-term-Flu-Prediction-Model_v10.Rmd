---
title: Short Term Influenza forecasting in the hospital environment using Bayesian Kalman filter
runninghead: Mani \emph{et al}.
author:
- name: Shankar Kaleeswaran Mani
  num: "1 2"
- name: Grzegorz A. Rempala
  num: "2"
- name: Eben Kenah 
  num: "2"
- name: Fernanda L. Schumacher 
  num: "2"
address:
- num: 1
  org: OhioHealth, Columbus, Ohio, USA
- num: 2
  org: Department of Biostatistics, The Ohio State University, Columbus, Ohio, USA
corrauth: "Fernanda L. Schumacher"
email: schumacher.313@osu.edu
abstract: "Accurate forecasting of weekly number of influenza (flu) lab test and positive cases is vital for hospitals to provide adequate patient care at the right time. It also helps prevent shortages or overages of staffs and supplies. In this paper we present a practical implementation of Bayesian Kalman filter methodology to forecast weekly flu test and positive cases in a hospital environment. By integrating  real time hospital data, this framework offers a robust methodology for accurately predicting flu volume one to four weeks out with a reasonable  accuracy. Through a comprehensive review of literature, we advocate that kalman filter based forecasting is an indispensable  tool for effective capacity management in a healthcare environment."
keywords: Bayesian Kalman filter; Influenza epidemic forecasting; Hospital capacity management; MCMC
classoption:
  - Royal
  - times
bibliography: bibfile.bib
bibliographystyle: sageh
header-includes:
  - \usepackage{graphicx}
  - \graphicspath{ {./images/} }
  - \usepackage{algorithm}
  - \usepackage{algpseudocode}
  - \usepackage{wrapfig}
  - \usepackage{float}
  - \floatplacement{figure}{H}
  - \usepackage{xcolor}
  - \usepackage{todo}
output:
  rticles::sage_article:
    keep_tex: yes
    number_sections: yes
---

\newcommand{\MVN}{\mathrm{MVN}}
\newcommand{\Beta}{\mathrm{Beta}}
\newcommand{\Unif}{\mathrm{Unif}}
\newcommand{\FLS}[1]{\textcolor{blue}{#1}}
\setcounter{secnumdepth}{3}

<!-- # The Article Header Information -->

<!-- YAML header: -->

<!-- ``` -->
<!-- output: -->
<!--   rticles::sim_article: -->
<!--     keep_tex: TRUE -->
<!-- ``` -->

<!-- Configure the YAML header including the following elements: -->

<!-- * `title`: Title -->

<!-- * `runninghead`: Author last names, use _et al._ if there are three or more authors. -->

<!-- * `author`: List of author(s) containing `name` and `num` -->

<!-- * `corrauth`: Corresponding author's name and address. -->

<!-- * `email`: Correspondence email -->

<!-- * `abstract`: Limited to 200 words -->

<!-- * `keywords`: Keywords for the article -->

<!-- * `bibliography`: BibTeX `.bib` file -->

<!-- * `bibliographystyle`: sageh or sagev -->

<!-- * `classoption`: options of the `sagej` class -->

<!-- ## Remarks -->

<!-- 2. `bibliographystyle` -->

<!-- 3. `classoption` -->

<!-- 4. Keywords are separated by commas. -->

# Introduction

Influenza places significant burden on US health care system annually \citep{blut2009influenza}\done\Todo{note that this citation is indirect and should use citep - change other instances accordingly}. According to \cite{CDCweb} (CDC), about 9 million to 41 million illnesses occurred between 2010 and 2023, resulting in 140,000-710,000 hospitalizations and 12,000-52,000 annual deaths. For the most recent seasonal year (October 2022-May 2023), CDC estimates about 31 million illness with 360,000 hospitalizations and 21,000 deaths. \done\Todo{why is it had to predict it? SM-we explained the reason elsewhere?}

During an influenza seasonal year, the provision of optimal patient care within a hospital system relies upon effective preparedness for incoming influenza patients \citep{fischer2016cdc,glasser2011modeling}. This motivation underscores the importance to develop a predictive model that enable hospitals to anticipate and accommodate fluctuations in weekly case volumes. Hence, an accurate seasonal influenza volume estimates is paramount to facilitate resource allocation, budgeting, and delivering quality patient care. By accurately forecasting weekly influenza cases one to four weeks out, our objective is to help hospital system strategize resource allocation, preemptively adjust staffing levels, optimize operational workflows to accommodate patient surges effectively and ensure an adequate supply of beds and laboratory test specimens.

The data used for this project is collected from OhioHealth, central Ohio, not-for-profit, mid size hospital system\done\Todo{can you mention the name? I will check}. We extracted data on the weekly count of all laboratory test performed and the resulting positive cases, beginning in 2016 September until August 2023. This period was chosen since the health system implemented a new Electronic Medical Record (EMR) system mid 2015, and reliable data was available only beginning September 2016 for all locations. 

For our analysis, we defined a seasonal influenza year as starting from September of a calendar year and ends in August of the subsequent year\done\Todo{is this a standard definition? SM-No standard definition}. The data includes all patients who had an influenza lab test order at one of the hospital location and whether they tested positive  \citep{rodrigo2012clinical,gavin2004review}. In total, we had 8 different seasonal influenza year data (September 2016 to August 2023).

Compartmental epidemic models \citep{kermack1927contribution}, such as the Susceptible-Infected-Recovered (SIR) model, offer valuable insights into the dynamics of infectious diseases, they are often geared towards understanding broader epidemiological trends, such as peak times and transmission rates, etc. Recent approaches linking SIR to survival analysis as in  \cite{khudabukhsh2020survival,khudabukhsh2023projecting} and \cite{Putter2024.02.18.24302991} were instrumental during COVID-19 epidemic. Another approach that allows ... \Todo{Introduce Kalman filter here. I am saying. SM - I am intorducing KF in the next section. Do we need another intro here? -- Since you mention an extension of it in the next paragraph, it would be good to have one sentence here introduction KF}

For further insights into the Extended Kalman Filter (EKF) methodology employed in influenza modeling study, readers are encouraged to refer to the work by \cite{shaman2012forecasting}. Additionally, for a comprehensive understanding of nationwide influenza forecasting, the CDC's publications on influenza Forecasting \citep{lutz2019applying} provide valuable context and insights into the recent development. For the immediate decision-making needs within hospital systems, where timely care for patients is critical \citep{meltzer2016modeling}, our focus lies in short-term prediction using readily available hospital data by taking advantage of the Kalman filter methodology. 

The rest of the manuscript is organized as follows\done\Todo{add}. Methods section  \ref{sec:methods} gives a gentle introduction to both linear Kalman filter and Bayesian Kalman filter methodologies to estimate parameters for forecasting weekly influenza lab test and positive cases. It details the development of our final models, including the derivation of informative priors \ref{sec:priors} from other seasonal years for the Markov Chain Monte Carlo (MCMC) estimation. In the results section \ref{sec:results}, we assess the performance of our final models by comparing actual versus predicted values over a 1 to 4-weeks forecasting horizon, evaluating performance metrics such as Mean Absolute Deviation (MAD) and coverage probability. Finally, we highlighted the strengths and weaknesses of our model in the discussion section \ref{sec:discussion}, along with suggestions for further improvements.

# Methods \label{sec:methods}

In this section we introduce a bivariate Bayesian Kalman filter framework to model and predict weekly total influenza lab test and positive cases. This approach is appealing given its ability to provide reasonable posterior distribution by combining the traditional Kalman filter with the Bayesian inference principle. The Kalman filter is an optimal filter for a Linear Gaussian process \Todo{mention averaging of influenza cases over time leads to a Gaussian process via Central limit theorem (CLT) add reference (Prof. Rempala could help here)}. While the dynamics of infectious disease epidemics, such as influenza, are inherently nonlinear and subject to complex interactions, our focus lies on short-term predictions (1 to 4 weeks), where it is reasonable to approximate the influenza dynamics as locally linear, thus rendering the Kalman filter an optimal choice for influenza incidence estimation \done\Todo{did not define state yet - move to later?}. Also, the use of Bayesian framework allowed us to borrow information from other seasonal years to create informative priors for the MCMC estimation process \citep{jackman2000estimation}. 

## Linear Kalman Filter

Kalman filter, which was first introduced by Rudolph Emil Kalman, is a method for state estimation in a dynamic system \citep{kalman1960new}. It has since been used in many areas such as Robotics motion planning, object navigation, signal processing and wireless networks to extract signal from noisy data. At a basic level, Kalman filter estimates the true state of a system at a current step (say $t$) by combining the estimate made at the previous step ($t-1$) for the current step ($t$) with the current observed value (at $t$) to better approximate the true state of the system at $t$. The current observed value is assumed to be noisy (could be due to faulty devices) and need a way to get a precise estimate of its true value\done\Todo{what do you mean with "better way"? Can we define what better hear mean?}. The aim of a filter is to find optimal values for the parameters by maximizing the likelihood of data observed or reducing the deviance between predicted state and observed value.

A Kalman filter has two steps that operates recursively at each time step: the predict (also called transition) and the update step; see Figure \ref{fig1}. The state equation predicts the next time step value. It also provides uncertainty of the prediction through a uncertainty extrapolation equation. We then adjust (update) these estimate using the observed value with the factor called Kalman gain (also known as innovation gain). The filter then uses the updated predictions and the state equation to predict the next step value and the system goes on in a loop. The filter has been extensively discussed in the literature, and details can be found in \cite{pei2019elementary}, for example.

<!-- ![Caption for the picture.](Figure1_Predict_Update_text_cut.png) -->
```{r echo= FALSE, out.width='95%', fig.cap="Predict and Update steps in a Kalman filter.\\label{fig1}"}
#setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
figure1 <- "Figure1_Predict_Update_edit.png"
knitr::include_graphics(figure1)
```
In this paper we propose a bivariate linear Kalman filter to model weekly total influenza tests ($T$) and the resulting positive cases ($P$) simultaneously in the OhioHealth hospital system \done\todo{refer to hospital system}. The assumption is that only a subset of patients affected by influenza shows up to a hospital system and the true number of infected patient population is unknown. Hence, the data is noisy and need an appropriate method to extract signal from noise. Therefore, Kalman filter seems like an ideal choice. We adopted a bivariate modeling approach to jointly capture the dynamics of weekly total lab tests and positive cases. This allows for a holistic representation of the relationship between these two variables, leveraging their interdependencies to enhance the accuracy and robustness of our forecasting model.  

Consider a bivariate state space model \citep[SSM,][]{auger2021guide} whose state and observation equation is linear with  multivariate normally distributed error, which can be defined as follows:

- \emph{State Equation:} 
    \begin{equation}\label{eq:ssmstate}
      S_{t} =  F S_{t-1} + E_{t-1},
    \end{equation}
where
    $$
     \begin{aligned}
        E_{t-1} \sim \MVN(0, \Sigma_{s}),& \,\ \Sigma_{s} = \begin{pmatrix}\sigma_T^2 & \rho_{s}\sigma_T\sigma_P \\ \rho_{s}\sigma_T\sigma_P & \sigma_P^2\\ \end{pmatrix}, \\
        F = \begin{pmatrix}\phi_1 & 0\\0 & \phi_2\\ \end{pmatrix},& \, \text{ and } S_{t} = \binom{T_t}{P_{t}}.
     \end{aligned} 
    $$
    
- \emph{Observation Equation:}
    \begin{equation}\label{eq:ssmobs}
       O_{t} =  H S_{t} + V_{t},
    \end{equation}
where
    $$
     \begin{aligned}
       V_{t} \sim \MVN(0, \Sigma_{o}), \,\ \Sigma_{o} = \begin{pmatrix}\nu_T^2 & \rho_{o}\nu_T\nu_P \\ \rho_{o}\nu_T\nu_P & \nu_P^2\\ \end{pmatrix}, \text{ and } O_{t} = \binom{T_{o,t}}{P_{o,t}}. \\
     \end{aligned} 
    $$

Following \cite{KFweb} and \cite{masnadi2019step}, the set of equations that are needed in a Kalman filter to perform the predict and update step are given by:

1. Predict Step \done\Todo{no hat on the right side?}:
   - \emph{Estimate next state value:} 
       \begin{equation} \label{eq:kfpredictpoint}
         \hat{S}_{t+1, t} =  F \hat{S}_{t,t};
       \end{equation}
    
   - \emph{Estimate next state variance:} 
       \begin{equation} \label{eq:kfpredictvar}
         \hat{P}_{t+1, t} =  F \hat{P}_{t,t} F^\top + \Sigma_{s};
       \end{equation}

2. Update Step:\done\Todo{no hat on the left side?}:
  
   - \emph{Compute Kalman gain ($K$):} 
       \begin{equation} \label{eq:kfgain} 
          \hat{K}_{t} = \hat{P}_{t, t-1}H^\top(H\hat{P}_{t, t-1}H^\top + \Sigma_{o})^{-1};
       \end{equation}
  
   - \emph{ Update state estimate:}
       \begin{equation} \label{eq:kfupdatepoint} 
         \hat{S}_{t, t}=  \hat{S}_{t, t-1} + \hat{K}_{t}(O_{t} - H\hat{S}_{t, t-1});
       \end{equation}
  
   - \emph{Update state variance:}
       \begin{equation} \label{eq:kfupdatevar} 
         \hat{P}_{t, t} =  (I-\hat{K}_{t}H)\hat{P}_{t, t-1}(I-\hat{K}_{t}H)^\top + \hat{K}_{t}\Sigma_{o}\hat{K}_{t}^\top.
       \end{equation}

\done\Todo{how do we initialize T and P? SM-Details given in the algorithm section}

## Bayesian Kalman Filter

\done\Todo{right? SM- Removed an old line}Aiming to deal with a bivariate model that jointly handle the total lab tests and positive cases\done\Todo{why joint modeling?SM - added text to the begining of linear kalman filter section}, the derivation of the estimates ($F$, $\Sigma_{s}$ and $\Sigma_{o}$) can be tedious but can easily be estimated through MCMC sampling. The set up of bivariate Kalman Bayesian MCMC model is shown in Algorithm \ref{algorithm1} and the corresponding rjags \citep{rjagsweb} code\done\Todo{add reference of rjags package} is available as a GitHub repository \Todo{change citation style or provide url directly (you might want to create a different repository to make public with only the files you want to share)}. 

\begin{algorithm}
\caption{Bayesian Kalman Filter.}\label{algorithm1}
\begin{algorithmic}
\Require Initialize step, at $t=0$:
  $$ \hat{S}_{1, 0} = S_{init}, $$
  $$ \hat{P}_{1, 0} = P_{init}. $$
 \For{$t$ in 1 to $n$}:

  1. Compute Kalman gain using \ref{eq:kfgain} \done\Todo{add reference to eq number}.
  
  2. Perform state and variance update using update equations given in \ref{eq:kfupdatepoint} and \ref{eq:kfupdatevar} \done\Todo{add reference to eq number} to obtain $(\hat{S}_{t, t}, \hat{P}_{t,t});$
  
  3. Predict next state value using updated estimates and tansition equation such that,
  
     $$ \hat{S}_{t+1, t} \sim \MVN(F\hat{S}_{t,t}, (F\hat{P}_{t,t} F^t + \Sigma_{s}));$$
     
  4. Assume multivariate normal distribution for observation likelihood, such that
  
     $$ {O_{t+1}} \sim \MVN(\hat{S}_{t+1, t}, \Sigma_{o}).$$
\EndFor
\end{algorithmic}
\end{algorithm}

The objective of the Algorithm \ref{algorithm1} is to estimate the parameters ($F$, $\Sigma_{s}$ and $\Sigma_{o}$), such that predicted state values $\hat{S}_{t+1,t}$ provides us with estimates and uncertainty of the hidden states reflecting the true incidence of influenza better than the observed observations $O_{t+1}$, which are considered to be noisy. 

## Final model for weekly lab test and positive case incidence 

\done\Todo{why is this a section? change this to 2.3 and subsequent to 2.4 etc. until 4}

We analyzed and modeled each seasonal influenza year independently but borrowed information from other years to construct an informative prior for all the parameters to be estimated through MCMC sampling. For example, when we analyzed 2016 seasonal data, information from 2017 to 2023 was used to form informative prior on all model parameters. Similarly, when we analyzed 2020 seasonal year data, we borrowed information from year 2016 to 2019 and 2021 to 2023. The rationale for this approach is that each influenza seasonal year has different dynamics such as the rate at which people get infected, peak time etc \citep{CDCfluvirus} \done\Todo{add refs to why the rate and peak are different for each year?SM - added a CDC site for why virus change}. By modeling them independently, we allow the model to reflect the differences we observe in reality, but still take advantage of information from other years by incorporating it as prior information. See Section \ref{sec:priors} for more details on how the priors were constructed. 

### Influenza Lab Test Model:

To model the number of weekly lab tests, we considered an ensemble model \done\Todo{might need to justify?}which integrates the estimates from two different Bayesian Kalman filter setup. After iterating through various model specifications, we found that the ensemble of two distinct Kalman filters produced the best results by optimizing Mean Absolute Deviation (MAD) and coverage probability metrics. Specifically, the first model in the ensemble excelled in predicting week 1 cases, while the second model performed better for week 4 predictions. Therefore, combining these two models enabled us to optimize predictions made 1 to 4 weeks ahead. 

The first model employs a straightforward bivariate autoregressive of order 1 (AR(1)) framework for total lab test and positive cases, similar to the one we considered for the bivariate state space model \ref{eq:ssmstate}. Within this framework, we modeled the uncertainty by specifying unknown state and observation covariance matrices (i.e. the correlation of errors between the two series in each matrix is non zero). The parameters $F$ (AR(1) parameters matrix), state, $\Sigma_{s}$, and observation, $\Sigma_{o}$, covariance matrices are to be estimated and the matrix H is an identity matrix. The priors for the parameters are informative and the information is borrowed from other seasonal years.

In contrast, the second model employs a bivariate autoregressive of order 1 (AR(1)) framework for total lab test and positive cases. However, correlation of errors in state and observation matrix is zero. By assuming zero correlation between the two series, we treat each series as an independent normal distributed random variable, effectively decoupling their respective dynamics. The model has first order autoregressive parameter, $\phi_{1}$, and a state and observation variance terms, $\sigma_{s}$ and $\sigma_{o}$, respectively, for each of the series, to be estimated through MCMC sampling. Again, the priors are informative with the information borrowed from other seasonal flu years.

We combined the two models within a Bayesian hierarchical framework to produce an ensemble estimate such that $M_{1}W_1 + M_{2}(1-W_1)$. This hierarchical setup facilitates integration of two models through an unknown weight parameter, \( W_1 \), governing the relative influence of each model. Critically, \( W_1 \) is not predetermined but instead inferred directly from the data with an informative beta prior, allowing the data to dictate the influence of each model on the final predictions. 

### Influenza Positive Cases Model:

For the weekly number of positive influenza cases, we considered a bivariate Kalman filter on a difference scale ($d=1$). The structure of this model is very similar to the model considered for total lab test above with few modifications. First, the two series were decoupled such that the correlation of their error terms is zero in both state and observation covariance matrix. Second, each series not only depends on the lagged value of its own but also the lagged value of the second series (see $F$ matrix structure below). Third, the second series (positive cases volume) has a covariate matrix $P_{t-1}$, a smoothed total lab test volume, derived by smoothing other seasonal year data. For example, if we are analyzing 2016 data, we derived a smoothed volume series from seasonal year 2017 to 2023. Finally, we did not use ensemble technique and only one bivariate Kalman filter was used. The priors for the parameters, $F, W,  \Sigma_{s},\Sigma_{o}$ are informative and the information is borrowed from other seasonal years (see Section \ref{sec:priors} for details). Note, $W$ is the coefficient for smoothed predictor $P_{t-1}$ to be estimated. 

- \emph{State Equation:}
    $$
     \begin{aligned}
       & S_{t} =  FS_{t-1} + WP_{t-1} + E_{t-1}, \\
      \end{aligned} 
    $$
  where 
    $$
     \begin{aligned}
       & {S}_{t} = \binom{ {{\Delta}T}_{t}} {{{\Delta}P}_{t}}, &\, F = \begin{pmatrix}\phi_{11} & \phi_{12}\\ \phi_{21} & \phi_{22}\\ \end{pmatrix}, \\
       & \Sigma_{s} = \begin{pmatrix}\sigma_T^2 & 0 \\ 0 & \sigma_P^2\\ \end{pmatrix},  &\
       E_{t-1} \sim \MVN(0, \Sigma_{s}); \\
     \end{aligned} 
    $$
- \emph{Observation Equation:}
    $$
     \begin{aligned}
       & {{\Delta}O}_{t} =  H S_{t} + V_{t}, \\
      \end{aligned} 
    $$
  where 
    $$
     \begin{aligned}
       & V_{t} \sim MVN(0, \Sigma_{o}), \\
       & \Sigma_{o} = \begin{pmatrix}\nu_T^2 & 0 \\ 0 & \nu_P^2\\ \end{pmatrix}, &\
       & {\Delta}O_{t} = \binom{{\Delta}T_{o,t}}{{\Delta}P_{o,t}}. \\
     \end{aligned} 
    $$

## Priors Definition for Bayesian Kalman Filter Model \label{sec:priors} 

In the Bayesian Kalman filter model for estimating weekly lab test and positive cases volume, we utilized informative priors by incorporating relevant historical information to enhance the estimation process. We formed informative priors for key parameters\done\Todo{two or three?}: the autoregressive matrix, $F$, the state ($\Sigma_{s}$) and observation ($\Sigma_{o}$) covariance matrix, and the weight parameter ($W_1$). These priors are designed to leverage insights from other seasonal flu years, thereby enabling our model for more accurate and robust estimation. This is also one of the main reason why we decided to use Bayesian MCMC estimation for the Kalman filter \Todo{can you clarify how the information of previous years was
used? Was it by fitting a non-informative model for each year and
using resulting estimates?}. 

### AR Parameters:

For the AR parameters, we first ran an uninformative beta priors and derived information from the analysis of flu data spanning multiple seasonal flu years. For example, for 2016 seasonal influenza year, we utilize the information from influenza seasons 2017 to 2023 to inform the priors for the AR parameters. By leveraging the patterns and dynamics observed in the other influenza seasons, we enhanced the model's ability to capture the temporal dependencies inherent in influenza process. We considered a beta distribution, and the hyperparameters were set by borrowing information from other seasonal influenza years.
$$
 \begin{aligned}
   & F = \begin{pmatrix}\phi_{11} & \phi_{12}\\ \phi_{21} & \phi_{22}\\ \end{pmatrix}, &\
   & \phi_{ij} \sim \Beta(a_{ij}, b_{ij}) \\
 \end{aligned}
$$

Here, we chose a beta prior because often the case that in a influenza cycle the incidences of cases are often positively correlated over time \done\Todo{can you add some reasoning why is must be postive?}
   
### State and Observation Covariance Matrix:

Similarly, informative priors were incorporated for the state and observation covariance matrix, which govern the uncertainty in the state dynamics and the relationship between the observed data and the underlying state variables. These priors were constructed based on the covariance structures observed in historical flu data. For instance, we first used an uninformative prior model then estimated the hyper parameters for Uniform using data from other seasonal years. By leveraging the covariance patterns observed in these years, we ensure that the model appropriately accounts for the variability and correlation present in flu volume data. For instance, consider state and observation covariance matrix below, all the hyper parameter values were formed from other seasonal years.

$$
  \begin{aligned}
    & \Sigma_{s} = \begin{pmatrix}\sigma_T^2 & \rho_{s}\sigma_T\sigma_P \\ \rho_{s}\sigma_T\sigma_P & \sigma_P^2\\ \end{pmatrix}, 
    &\, \Sigma_{o} = \begin{pmatrix}\nu_T^2 &  \rho_{o}\nu_T\nu_P \\ \rho_{o}\nu_T\nu_P & \nu_P^2\\ \end{pmatrix}, \\
    & \sigma_T \sim \Unif(T_{s.a}, T_{s.b}), &\ \sigma_P \sim \Unif(P_{s.a}, P_{s.b}), \\
    & \rho_{s} \sim \Unif(\rho_{s.a}, \rho_{s.b}), &\ \nu_T \sim \Unif(T_{o.a}, T_{o.b}), \\
    & \nu_P \sim \Unif(P_{o.a}, P_{o.b}), &\ \rho_{o} \sim \Unif(\rho_{o.a}, \rho_{o.b}). \\
  \end{aligned} 
$$

\done\Todo{check subindex - should a and b have regular size? SM - Do you mean the font for a and b be bigger? - Yes, the full size dot a and dot b look off}

### Ensemble Weight Parameter:

Finally, in the ensemble model for total lab cases, the weight parameter, \(W_{1}\), is informative beta prior and the information is borrowed from other influenza years.

$$
 \begin{aligned}
   & W_1 \sim \Beta(W_{a}, W_{b}). \\
 \end{aligned} 
$$
It is worth emphasizing that the informative priors are formed for each seasonal year by borrowing information across other seasonal flu years, with each year contributing to the construction of the priors. This approach allowed us to capture the different influenza dynamics in the other seasons, leading to more informed and reliable estimation.

# Results \label{sec:results}
## Data Summary

The dataset encompasses weekly counts of lab test and influenza cases recorded across multiple seasonal years, spanning from September 2016 to August 2023, extracted from a Hospital EMR system. Notably, the dataset includes observations from both traditional influenza seasons (2016 to early 2020) and COVID years (early 2020 to 2023), during which the testing and incidence for COVID-19 significantly impacted public health surveillance efforts and confounded the lab test and influenza case volume.

Figure \ref{fig:figure1} plots the incidence of weekly lab test and positive cases across different seasonal years. Figures \ref{fig:figure2} and \ref{fig:figure2-2} depicts a box plot of lab test and influenza case counts by seasonal year, providing a visual representation of the variability and distribution of flu activity across different years. The inclusion of COVID years in the dataset underscores the dynamic nature of public health surveillance and the challenges posed by overlapping epidemics and introduces confounding factors, such as increased COVID test volume and heightened awareness of respiratory illness. We can clearly see that volume of lab test is significantly higher during the COVID years highlighting this confounding. This was also one of the reason why we modeled each influenza seasonal independently but borrowed information from one another through informative priors.

```{r eval=TRUE, figure-1, fig.cap = "Incidence of cases by Seasonal Years. Total lab test volume (in red) and Positive case volume (in blue).\\label{fig:figure1}", warning=FALSE, message=FALSE, echo=FALSE, fig.width=5.5, fig.height=4, out.width="90%", fig.show='hold', fig.align='center'}
#out.width="98%", out.height="30%"

library(tidyverse)
library(gridExtra)

#setwd(dirname(rstudioapi::getActiveDocumentContext()$path))

multi_step_ensem_informPrior_forecast_v3 <- read.csv("../modelOutputData/kf_multi_step_ensem_beta_informPrior_forecast_v2.csv", header = T)

kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 <- read.csv("../modelOutputData/kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4.csv", header = T)

kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 %>% 
  group_by(seasonal_Year, id) %>% 
  ggplot(data=., aes(x=id, y=total_vol, color="Lab test")) +
  geom_line() +
  geom_line(aes(x=id, y=Detected, color="Positive Cases")) +
  facet_wrap(vars(seasonal_Year), scales = 'free', nrow = 2) +
  theme_bw() +
  xlab("Seasonal Week") + ylab("Cases") +
  #ggtitle("Incidence by Influenza Years") +
  theme(legend.position="none")
```

```{r eval=TRUE, figure-2, fig.cap = "Box Plot of Total Lab test by Influenza Seasonal Year.\\label{fig:figure2}", warning=FALSE, message=FALSE, echo=FALSE, out.width="90%", fig.show='hold',fig.align='center', fig.width=6, fig.height=3.5}
#out.height="30%"
oh_actual_stats <- kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 %>% 
  distinct(id, seasonal_Year, total_vol, Detected) %>% 
  group_by(seasonal_Year) %>% 
  summarize(mean_total_vol = mean(total_vol),
            median_total_vol = median(total_vol),
            mean_Detected = mean(Detected),
            median_Detected = median(Detected),
            )

multi_step_ensem_informPrior_forecast_v3 %>% 
  ggplot(data=., aes(x=as.factor(seasonal_Year), y=total_vol)) +
  geom_boxplot() +
  geom_text(data=oh_actual_stats, aes(as.factor(seasonal_Year), 
             round(median_total_vol), label = round(median_total_vol)), 
              position = position_dodge(width = 0.75), size = 2.5, vjust = -0.5)+
  ylab("Total Lab Test")+xlab("Seasonal Years")+
  theme(legend.position="bottom")+
  theme_bw()+
  guides(colour = guide_legend(nrow = 2))
```

```{r eval=TRUE, figure-2-2, fig.cap = "Box Plot of Positive cases by Influenza Seasonal Year.\\label{fig:figure2-2}", warning=FALSE, message=FALSE, echo=FALSE, out.width="90%", fig.show='hold',fig.align='center', fig.width=6, fig.height=3.5}
#out.height="30%"
oh_actual_stats <- kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 %>% 
  distinct(id, seasonal_Year, total_vol, Detected) %>% 
  group_by(seasonal_Year) %>% 
  summarize(mean_total_vol = mean(total_vol),
            median_total_vol = median(total_vol),
            mean_Detected = mean(Detected),
            median_Detected = median(Detected),
            )

multi_step_ensem_informPrior_forecast_v3 %>% 
  ggplot(data=., aes(x=as.factor(seasonal_Year), y=Detected)) +
  geom_boxplot() +
  geom_text(data=oh_actual_stats, aes(as.factor(seasonal_Year), 
             round(median_Detected), label = round(median_Detected)), 
              position = position_dodge(width = 0.75), size = 2.5, vjust = -0.5)+
  ylab("Positive Cases")+xlab("Seasonal Years")+
  theme(legend.position="bottom")+
  theme_bw()+
  guides(colour = guide_legend(nrow = 2))
```

## Predicting Influenza Lab test and Positive Cases using rolling 4 Weeks Out Forecast

In this section, we present the results of predicting weekly total lab test and positive flu cases 1 to 4 weeks out using the bivariate Bayesian Kalman filter approach described above. The predictive performance of the model was evaluated using a rolling forecasting framework, where forecasts were generated for the next weeks 4 out at each forecasting horizon, week 4 to 52 of a seasonal year. The predicted volume, along with their corresponding 95% credible intervals, were compared against the actual cases for each forecasting horizon. Figures \ref{fig:figure3noncovid}-\ref{fig:figure3-2covid} illustrate the comparison.

The rolling forecast methodology involved generating forecasts 1 to 4 weeks ahead using a rolling window (horizon) that started at week 4 and extended up to week 52 of the seasonal year. At each iteration of the rolling window, the model was trained on historical flu data up to the forecast horizon and predictions (and credible intervals) were made for the next 4 weeks from the forecasting horizon. 

```{r eval=TRUE, figure-3.1, fig.cap = "Total Lab test Actuals vs. Prediction 1 to 4 weeks out (non COVID years).\\label{fig:figure3noncovid}", warning=FALSE, message=FALSE, echo=FALSE, out.width="90%",  fig.align='center',  fig.width=6, fig.height=5}
#out.height="30%",

### plots of actual vs forecast
jags_model_filter <- c("kf_ensemble")
for (var in c("total_vol")){
  
  plot_1 <-  multi_step_ensem_informPrior_forecast_v3 %>% 
    filter( seasonal_Year %in% c(2016:2020) 
           & model %in% jags_model_filter & id >=6) %>% 
  do(plots = ggplot(data=., aes(x=id, y=.data[[var]])) + 
    geom_point(aes(colour="Actual"), size=1) +
    geom_line(aes(x=id, y=.data[[paste("fit_", var, "_ensem", sep="")]], colour="Predict"), size=0.8) +
      geom_ribbon(aes(ymin = .data[[paste("lwr_", var, "_ensem", sep="")]], 
                    ymax = .data[[paste("upr_", var, "_ensem", sep="")]]), alpha = 0.4)+
    scale_colour_manual("", values = c("red", "blue")) +
    scale_fill_manual("", values = c("red", "blue")) +
    facet_grid(seasonal_Year~forecast_step,scales = "free_y",
               space = "fixed", shrink = TRUE,
               labeller = "label_value", as.table = TRUE, drop = TRUE) +
    theme_bw()+
    theme(legend.position = "top")+
    xlab("Seasonal Week") + ylab("Lab test")
    #+ggtitle("Actual vs Predictions for Total Lab test 1 to 4 weeks out (Non COVID Years)")
    )
  
  # print(plot_1$plots)
  walk(plot_1$plots, print)
}
```

```{r eval=TRUE, figure-3.1-2, fig.cap = "Total Lab test Actuals vs. Prediction 1 to 4 weeks out (COVID years).\\label{fig:figure3covid}", warning=FALSE, message=FALSE, echo=FALSE, out.width="90%",  fig.align='center',  fig.width=6, fig.height=3.5}
#out.height="30%",

### plots of actual vs forecast
jags_model_filter <- c("kf_ensemble")
for (var in c("total_vol")){

  plot_2 <-  multi_step_ensem_informPrior_forecast_v3 %>%
    filter( seasonal_Year %in% c(2021:2023)
           & model %in% jags_model_filter & id >=6) %>%
  do(plots = ggplot(data=., aes(x=id, y=.data[[var]])) +
    geom_point(aes(colour="Actual"), size=1) +
    geom_line(aes(x=id, y=.data[[paste("fit_", var, "_ensem", sep="")]], colour="Predict"), size=0.8) +
    geom_ribbon(aes(ymin = .data[[paste("lwr_", var, "_ensem", sep="")]],
                    ymax = .data[[paste("upr_", var, "_ensem", sep="")]]), alpha = 0.4)+
    scale_colour_manual("", values = c("red", "blue")) +
    scale_fill_manual("", values = c("red", "blue")) +
    facet_grid(seasonal_Year~forecast_step,scales = "free_y",
               space = "fixed", shrink = TRUE,
               labeller = "label_value", as.table = TRUE, drop = TRUE) +
    theme_bw()+
    theme(legend.position = "top")+
    xlab("Seasonal Week") + ylab("Lab test")
    #+ggtitle("Actual vs Prediction for  Total Lab test 1 to 4 weeks out (COVID Years)")
    )

  # print(plot_2$plots)
  walk(plot_2$plots, print)
}
```

```{r eval=TRUE, figure-3.2, fig.cap = "Positive Cases Actuals vs. Prediction 1 to 4 weeks out (non COVID years)\\label{fig:figure3-2noncovid}", warning=FALSE, message=FALSE, echo=FALSE, out.width="90%",  fig.show='hold',fig.align='center',   fig.width=6, fig.height=5}

kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 <- kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 %>%  
  mutate(upr_Detected = ifelse((upr_Detected > 100 & seasonal_Year == 2021), 100, upr_Detected))

jags_model_filter <- c("bivar_kfar1gaussJags_cov_6_diff")
for (var in c("Detected")){
  
  plot_1 <-  kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 %>% 
    filter( seasonal_Year %in% c(2016:2020) 
           & model %in% jags_model_filter & id >=6) %>% 
  do(plots = ggplot(data=., aes(x=id, y=.data[[var]])) + 
    geom_point(aes(colour="Actual"), size=1) +
    geom_line(aes(x=id, y=.data[[paste("fit_", var, sep="")]], colour="Predict"), size=0.8) +
      geom_ribbon(aes(ymin = .data[[paste("lwr_", var, sep="")]], 
                    ymax = .data[[paste("upr_", var, sep="")]]), alpha = 0.4)+
    scale_colour_manual("", values = c("red", "blue")) +
    scale_fill_manual("", values = c("red", "blue")) +
    facet_grid(seasonal_Year~forecast_step,scales = "free_y",
               space = "fixed", shrink = TRUE,
               labeller = "label_value", as.table = TRUE, drop = TRUE) +
    theme_bw()+
    theme(legend.position = "bottom")+
    xlab("Seasonal Week") + ylab("Positive cases")
    # +ggtitle("Actual vs Prediction of Positive Cases 1 to 4 weeks out (Non COVID Years)")
    )
  
  #print(plot_1$plots)
  walk(plot_1$plots, print)
}
```

```{r eval=TRUE, figure-3.2-2, fig.cap = "Positive Cases Actuals vs. Prediction 1 to 4 weeks out (COVID years).\\label{fig:figure3-2covid}", warning=FALSE, message=FALSE, echo=FALSE, out.width="90%",  fig.show='hold',fig.align='center',   fig.width=6, fig.height=3.5}

kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 <- kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 %>%  
  mutate(upr_Detected = ifelse((upr_Detected > 100 & seasonal_Year == 2021), 100, upr_Detected))

jags_model_filter <- c("bivar_kfar1gaussJags_cov_6_diff")
for (var in c("Detected")){

  plot_2 <-  kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 %>%
    filter( seasonal_Year %in% c(2021:2023)
           & model %in% jags_model_filter & id >=6) %>%
  do(plots = ggplot(data=., aes(x=id, y=.data[[var]])) +
    geom_point(aes(colour="Actual"), size=1) +
    geom_line(aes(x=id, y=.data[[paste("fit_", var, sep="")]], colour="Predict"), size=0.8) +
    geom_ribbon(aes(ymin = .data[[paste("lwr_", var, sep="")]],
                    ymax = .data[[paste("upr_", var, sep="")]]), alpha = 0.4)+
    scale_colour_manual("", values = c("red", "blue")) +
    scale_fill_manual("", values = c("red", "blue")) +
    facet_grid(seasonal_Year~forecast_step,scales = "free_y",
               space = "fixed", shrink = TRUE,
               labeller = "label_value", as.table = TRUE, drop = TRUE) +
    theme_bw()+
    theme(legend.position = "bottom")+
    xlab("Seasonal Week") + ylab("Positive cases")
    #+ggtitle("Actual vs Prediction of Positive Cases 1 to 4 weeks out (COVID Years)")
    )

  #print(plot_2$plots)
  walk(plot_2$plots, print)
}
```

## Assessment of Predictive Performance

The accuracy and reliability of the predictions were assessed using standard performance metrics such as mean absolute deviation (MAD), and percent of observations contained with in the 95% credible intervals (coverage probability) for each of the predictions made 1 to 4 weeks out. Figure \ref{fig:figure4}\done\Todo{check plot labels. SM- What do I change here? -- Maybe remove "forecast"} illustrates the performance of the models. 

```{r figure-4, fig.cap = "Model Performance. Mean absolute deviation (MAD) and coverage probability for total lab test (top) and for Positive cases (bottom).\\label{fig:figure4}", warning=FALSE, message=FALSE, echo=FALSE, out.width="49%", fig.show='hold', fig.align='center', fig.width=4, fig.height=3}

library(tidyverse)
# library(gridExtra)

#setwd(dirname(rstudioapi::getActiveDocumentContext()$path))

# multi_step_ensem_informPrior_forecast_v3 <- read.csv("../modelOutputData/kf_multi_step_ensem_beta_informPrior_forecast_v2.csv", header = T)
# 
# kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 <- read.csv("../modelOutputData/kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4.csv", header = T)

### Total Lab test volume plots of model performance metrics (MAD and % within CI)

kf_multi_step_ensem_informPrior_forecast_metrics <- multi_step_ensem_informPrior_forecast_v3 %>%
  filter(id>4) %>% 
  group_by(seasonal_Year, dep_var, forecast_step, model) %>% 
  mutate(res_total_vol = total_vol-fit_total_vol_ensem, 
         #res_Detected = Detected-fit_Detected,
         total_vol_within_CI = ifelse((total_vol>=lwr_total_vol_ensem & total_vol<=upr_total_vol_ensem),1,0) 
         #,Detected_within_CI = ifelse((Detected>=lwr_Detected & Detected<=upr_Detected),1,0)
        )

kf_multi_step_ensem_informPrior_forecast_metrics_v2 <- kf_multi_step_ensem_informPrior_forecast_metrics %>%   group_by(seasonal_Year, dep_var, forecast_step, model) %>% 
  summarize(MAD_total_vol = mean(abs(res_total_vol)),
            #MAD_Detected = mean(abs(res_Detected)),
            percent_total_vol_within_CI = mean(total_vol_within_CI)
            #,percent_Detected_within_CI = mean(Detected_within_CI)
            )

kf_ensem_informPrior_forecast_stats <- kf_multi_step_ensem_informPrior_forecast_metrics_v2 %>%
  group_by(dep_var, forecast_step, model) %>% 
  summarize(mean_MAD_total_vol = mean(MAD_total_vol),
            median_MAD_total_vol = median(MAD_total_vol),
            #mean_MAD_Detected = mean(MAD_Detected),
            #median_MAD_Detected = median(MAD_Detected),
            mean_percent_total_vol_within_CI = mean(percent_total_vol_within_CI),
            median_percent_total_vol_within_CI = median(percent_total_vol_within_CI)
            #,mean_percent_Detected_within_CI = mean(percent_Detected_within_CI),
            #median_percent_Detected_within_CI = median(percent_Detected_within_CI)
            )

kf_multi_step_ensem_informPrior_forecast_metrics_v2 %>% 
  ggplot(data=., aes(x=as.factor(forecast_step), y=MAD_total_vol)) +
  geom_boxplot() +
  # facet_wrap(vars(dep_var), scales = 'free', nrow = 2) +
  #ggtitle("Total Lab Test permodel performance metriccs: MAD") +
  geom_text(data=kf_ensem_informPrior_forecast_stats, aes(as.factor(forecast_step), 
                                                        round(median_MAD_total_vol), label = round(median_MAD_total_vol)), 
              position = position_dodge(width = 0.75), size = 2.5, vjust = -0.5)+
  xlab("No. of Weeks ahead") + ylab("MAD")+
  #ylim(0, 1000)+
  theme(legend.position="bottom")+
  theme_bw()+
  guides(colour = guide_legend(nrow = 2))

kf_multi_step_ensem_informPrior_forecast_metrics_v2 %>% 
  ggplot(data=., aes(x=as.factor(forecast_step), y=percent_total_vol_within_CI)) +
  geom_boxplot() +
  # facet_wrap(vars(dep_var), scales = 'free', nrow = 2) +
  #ggtitle("Total Lab Test model performance metric: Percent Actuals within Credible Interval") +
  geom_text(data=kf_ensem_informPrior_forecast_stats, aes(as.factor(forecast_step), 
                                                        round(median_percent_total_vol_within_CI,2), 
                                                        label= round(median_percent_total_vol_within_CI,2)), 
              position = position_dodge(width = 0.75), size = 2.5, vjust = -0.5)+
  xlab("No. of Weeks ahead") + ylab("Coverage probability")+
  theme(legend.position="bottom")+
  theme_bw()+
  guides(colour = guide_legend(nrow = 2))

### Total Positive case volume plots of model performance metrics (MAD and % within CI)

kf_multi_step_bivar_diff_informPrior_forecast_metrics <- kf_multi_step_bivar_cov_6_diff_informPrior_forecast_v4 %>%
  filter(id>5) %>% 
  group_by(seasonal_Year, dep_var, forecast_step, model) %>% 
  mutate(res_total_vol = total_vol-fit_total_vol, 
         res_Detected = Detected-fit_Detected,
         total_vol_within_CI = ifelse((total_vol>=lwr_total_vol & total_vol<=upr_total_vol),1,0), 
         Detected_within_CI = ifelse((Detected>=lwr_Detected & Detected<=upr_Detected),1,0)
        )


kf_multi_step_bivar_diff_informPrior_forecast_metrics_v2 <- kf_multi_step_bivar_diff_informPrior_forecast_metrics %>% 
  group_by(seasonal_Year, dep_var, forecast_step, model) %>% 
  summarize(MAD_total_vol = mean(abs(res_total_vol)),
            MAD_Detected = mean(abs(res_Detected)),
            percent_total_vol_within_CI = mean(total_vol_within_CI),
            percent_Detected_within_CI = mean(Detected_within_CI)
            )

kf_bivar_diff_informPrior_forecast_stats <- kf_multi_step_bivar_diff_informPrior_forecast_metrics_v2 %>%
  group_by(dep_var, forecast_step, model) %>% 
  summarize(mean_MAD_total_vol = mean(MAD_total_vol),
            median_MAD_total_vol = median(MAD_total_vol),
            mean_MAD_Detected = mean(MAD_Detected),
            median_MAD_Detected = median(MAD_Detected),
            mean_percent_total_vol_within_CI = mean(percent_total_vol_within_CI),
            median_percent_total_vol_within_CI = median(percent_total_vol_within_CI),
            mean_percent_Detected_within_CI = mean(percent_Detected_within_CI),
            median_percent_Detected_within_CI = median(percent_Detected_within_CI)
            )

kf_multi_step_bivar_diff_informPrior_forecast_metrics_v2 %>% 
  ggplot(data=., aes(x=as.factor(forecast_step), y=MAD_Detected)) +
  geom_boxplot() +
  geom_text(data=kf_bivar_diff_informPrior_forecast_stats, aes(as.factor(forecast_step), 
                                                        round(median_MAD_Detected), label = round(median_MAD_Detected)), 
              position = position_dodge(width = 0.75), size = 2.5, vjust = -0.5)+
   #ylim(0, 750)+
  xlab("No. of Weeks ahead") + ylab("MAD")+
  theme(legend.position="bottom")+
  theme_bw()+
  guides(colour = guide_legend(nrow = 2))

kf_multi_step_bivar_diff_informPrior_forecast_metrics_v2 %>% 
  ggplot(data=., aes(x=as.factor(forecast_step), y=percent_Detected_within_CI)) +
  geom_boxplot() +
  geom_text(data=kf_bivar_diff_informPrior_forecast_stats, aes(as.factor(forecast_step), 
                                                        round(median_percent_Detected_within_CI,2), 
                                                        label= round(median_percent_Detected_within_CI,2)), 
              position = position_dodge(width = 0.75), size = 2.5, vjust = -0.5)+
  xlab("No. of Weeks ahead") + ylab("Coverage probability")+
  theme(legend.position="bottom")+
  theme_bw()+
  guides(colour = guide_legend(nrow = 2))

```

## Summary and Results

For predictions made for 1 and 2 weeks ahead, the model demonstrated robust performance, with MAD and coverage probabilities within acceptable value, indicating accurate predictions for both lab test and positive cases. Week 3 predictions also exhibited satisfactory performance, albeit with slightly higher MAD value and lower coverage probability. However, the model encountered challenges in predicting volume 4 weeks ahead. Week 4 predictions showed slightly elevated MAD values and lower coverage probabilities compared to earlier forecasting horizons underpinning the difficulty in predicting the lab test and positive case volume four weeks out.

Note that we implemented two distinct bivariate models to forecast weekly influenza lab test and positive cases, with each model focusing on optimizing performance for its respective outcome. Lab test model excelled in predicting lab test volume even though both lab test and positive cases were modeled together, while the positive case model demonstrated better accuracy in predicting positive cases.

# Discussion \label{sec:discussion}

In summary, the prediction model demonstrated satisfactory performance for forecasting horizons of one to four weeks out. These forecast can be made and updated weekly with real time hospital data and can be modified to produce for a specific hospital location or catchment area. The model's accuracy was slightly diminished for predictions made four weeks ahead \Todo{maybe instead mention why 4 weeks ahead is particularly challenging?}, highlighting the inherent challenges and limitations associated with long-term forecasting in the context of seasonal influenza dynamics. We experimented different Kalman filters with various ARIMA parameters (p,d,q) including a model using the KFAS package \citep{helske2016kfas}. Our selection of the final model was based on minimizing the Mean Absolute Deviation (MAD) and optimizing coverage probability. Through this iterative process, we identified the model that balanced accuracy and reliability in forecasting weekly influenza lab test and positive cases. 

While our study employed a linear Gaussian Kalman filter for forecasting weekly influenza lab test and positive cases, it is important to acknowledge that these outcomes are better modeled as count processes, such as Poisson distributions. However, Kalman filter, version discussed in this paper, optimal only for linear Gaussian processes, we opted to remain within the Gaussian realm for our modeling approach because for large counts data Gaussian can be reasonable approximation \done\Todo{mention that for large counts gaussian can be reasonable approximation?}. An avenue for improvement is to adopt a count process framework and refining the Kalman filter methodology \citep{ribeiro2004kalman} to better accommodate the non linearity and count nature of influenza. These findings underscore the need for further research and refinement of modeling approaches to improve the accuracy and reliability of influenza forecasting. 


\todos

<!-- # Bibliography -->

<!-- Link a `.bib` document via the YAML header, and bibliography will be printed at the very end (as usual). The default bibliography style is provided by Wiley as in `WileyNJD-AMA.bst`, do not delete that file. -->

<!-- Use the Rmarkdown equivalent of the \LaTeX citation system using `[@<name>]`. Example: [@Taylor1937], [@Knupp1999; @Kamm2000]. -->

<!-- To include all citation from the `.bib` file, add `\nocite{*}` before the end of the document. -->

<!-- # Further information -->

<!-- All \LaTeX environments supported by the main template are supported here as well; see the `.tex` sample file [here](http://onlinelibrary.wiley.com/journal/10.1002/(ISSN)1097-0258/homepage/la_tex_class_file.htm) for more details and example. -->